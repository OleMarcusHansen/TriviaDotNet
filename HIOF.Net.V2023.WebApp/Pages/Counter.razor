@page "/counter"
@using GetTrivia.ConsoleService.Model;

<PageTitle>Quiz</PageTitle>

<h1>Welcome to Quizgame</h1>
<p>Tast inn kategori</p>
<select @bind="pickCategory">
    <option value="music">music</option>
    <option value="sport_and_leisure">sport and leisure</option>
    <option value="film_and_tv">film and tv</option>
    <option value="arts_and_literature">arts_and_literature</option>
    <option value="history">history</option>
    <option value="society_and_culture">society_and_culture</option>
    <option value="science">science</option>
    <option value="geography">geography</option>
    <option value="food_and_drink">food_and_drink</option>
    <option value="general_knowledge">general_knowledge</option>
</select>
<br>
<br>

<p>Tast inn antall spørsmål:</p>
<input type="number" @bind-value="@amount" />
<br>
<br>

<p>Tast inn vanskeligsgraden:</p>
<select @bind="pickDifficulty">
    <option value="easy">easy</option>
    <option value="medium">medium</option>
    <option value="hard">hard</option>
</select>
<br>
<br>


<button class="btn btn-primary" @onclick="HandleClick">Click me</button>

<br>
<br>

<h1>Trivia Questions</h1>

@if (questions == null)
    {
        <p>Loading questions...</p>
    }
else
{
        <ul>
        @foreach (var question in questions)
        {
            <li>
                <h2>@question.Question</h2>
                <p>@question.CorrectAnswer</p>
                @foreach (var answer in question.IncorrectAnswers)
                {
                <p>@answer</p>
                }
             </li>
        }
        </ul>
}

@code {
    private int currentCount = 0;
    private string pickCategory = "history";
    private string pickDifficulty = "easy";
    private int amount = 1;
    private Quest[] questions;


    private void HandleClick()
    {
        var url = $"https://localhost:7107/api/1.0/GetTrivia/TriviaCa?category={pickCategory}&numbersofQuestions={amount}&difficulty={pickDifficulty}";

        //få httpclient t interface?
        using var client = new HttpClient();
        var jsonQnA = client.GetFromJsonAsync<Quest[]>(url).Result;

        questions = jsonQnA;

        Console.WriteLine(questions);

        //foreach (var jsonQn in jsonQnA)
        //{
        //    //Console.WriteLine("Press enter to get next question \n");
        //    Console.WriteLine(jsonQn.Question);
        //    Console.WriteLine("Alternatives: ");
        //    string[] allAnswers = new string[jsonQn.IncorrectAnswers.Length + 1];
        //    Array.Copy(jsonQn.IncorrectAnswers, allAnswers, jsonQn.IncorrectAnswers.Length);
        //    allAnswers[allAnswers.Length - 1] = jsonQn.CorrectAnswer;
        //    Array.Sort(allAnswers);
        //    for (int i = 0; i < allAnswers.Length; i++)
        //    {
        //        Console.WriteLine((i + 1) + ". " + allAnswers[i]);
        //    }
        //    Console.WriteLine("");
        //    Console.WriteLine("Skriv ditt svar:");
        //    var answerInput = Console.ReadLine();
        //    Console.WriteLine("");
        //    if (allAnswers[int.Parse(answerInput) - 1] == jsonQn.CorrectAnswer)
        //    {
        //        Console.WriteLine("Correct!");
        //    }
        //    else
        //    {
        //        Console.WriteLine("Wrong, the answer was: " + jsonQn.CorrectAnswer);
        //    }
        //    Console.WriteLine("\n");
        //}
        //Console.WriteLine("Thank you for playing, press Enter to close");
        //Console.ReadLine();


        //Console.WriteLine("test push");
    }
}

